‰0
NC:\Visual\Pruebas\ClinicManager\ClinicManager\Services\ProcedimientoService.cs
	namespace 	
ClinicManager
 
. 
Services  
{ 
public 

class !
ProcedimientosService &
{ 
private		 
readonly		 
AppDBContext		 %

_dbContext		& 0
;		0 1
public !
ProcedimientosService $
($ %
AppDBContext% 1
	dbContext2 ;
); <
{ 	

_dbContext 
= 
	dbContext "
;" #
} 	
public 
async 
Task 
< 
List 
< 
Procedimiento ,
>, -
>- .%
GetAllProcedimientosAsync/ H
(H I
)I J
{ 	
return 
await 

_dbContext #
.# $
Procedimientos$ 2
.2 3
Include3 :
(: ;
p; <
=>= ?
p@ A
.A B
CitaB F
)F G
.G H
ToListAsyncH S
(S T
)T U
;U V
} 	
public 
async 
Task 
< 
Procedimiento '
?' (
>( )%
GetProcedimientoByIdAsync* C
(C D
intD G
idH J
)J K
{ 	
return 
await 

_dbContext #
.# $
Procedimientos$ 2
.2 3
Include3 :
(: ;
p; <
=>= ?
p@ A
.A B
CitaB F
)F G
.G H
FirstOrDefaultAsyncH [
([ \
p\ ]
=>^ `
pa b
.b c
IdProcedimientoc r
==s u
idv x
)x y
;y z
} 	
public 
async 
Task !
AddProcedimientoAsync /
(/ 0
Procedimiento0 =
procedimiento> K
)K L
{ 	
if 
( 
string 
. 
IsNullOrWhiteSpace )
() *
procedimiento* 7
.7 8
Descripcion8 C
)C D
)D E
throw 
new 
ValidationException -
(- .
$str. T
)T U
;U V
if 
( 
procedimiento 
. 
Costo #
<$ %
$num& '
)' (
throw   
new   
ValidationException   -
(  - .
$str  . T
)  T U
;  U V
var"" 

citaExiste"" 
="" 
await"" "

_dbContext""# -
.""- .
Citas"". 3
.""3 4
AnyAsync""4 <
(""< =
c""= >
=>""? A
c""B C
.""C D
IdCita""D J
==""K M
procedimiento""N [
.""[ \
IdCita""\ b
)""b c
;""c d
if## 
(## 
!## 

citaExiste## 
)## 
throw$$ 
new$$ 
NotFoundException$$ +
($$+ ,
$str$$, M
)$$M N
;$$N O

_dbContext&& 
.&& 
Procedimientos&& %
.&&% &
Add&&& )
(&&) *
procedimiento&&* 7
)&&7 8
;&&8 9
await'' 

_dbContext'' 
.'' 
SaveChangesAsync'' -
(''- .
)''. /
;''/ 0
}(( 	
public** 
async** 
Task** $
UpdateProcedimientoAsync** 2
(**2 3
Procedimiento**3 @
procedimiento**A N
)**N O
{++ 	
if,, 
(,, 
string,, 
.,, 
IsNullOrWhiteSpace,, )
(,,) *
procedimiento,,* 7
.,,7 8
Descripcion,,8 C
),,C D
),,D E
throw-- 
new-- 
ValidationException-- -
(--- .
$str--. T
)--T U
;--U V
if// 
(// 
procedimiento// 
.// 
Costo// #
<//$ %
$num//& '
)//' (
throw00 
new00 
ValidationException00 -
(00- .
$str00. T
)00T U
;00U V
var22 

citaExiste22 
=22 
await22 "

_dbContext22# -
.22- .
Citas22. 3
.223 4
AnyAsync224 <
(22< =
c22= >
=>22? A
c22B C
.22C D
IdCita22D J
==22K M
procedimiento22N [
.22[ \
IdCita22\ b
)22b c
;22c d
if33 
(33 
!33 

citaExiste33 
)33 
throw44 
new44 
NotFoundException44 +
(44+ ,
$str44, M
)44M N
;44N O

_dbContext66 
.66 
Procedimientos66 %
.66% &
Update66& ,
(66, -
procedimiento66- :
)66: ;
;66; <
await77 

_dbContext77 
.77 
SaveChangesAsync77 -
(77- .
)77. /
;77/ 0
}88 	
public:: 
async:: 
Task:: $
DeleteProcedimientoAsync:: 2
(::2 3
Procedimiento::3 @
procedimiento::A N
)::N O
{;; 	
if<< 
(<< 
procedimiento<< 
==<<  
null<<! %
)<<% &
throw== 
new== 
NotFoundException== +
(==+ ,
$str==, I
)==I J
;==J K

_dbContext?? 
.?? 
Procedimientos?? %
.??% &
Remove??& ,
(??, -
procedimiento??- :
)??: ;
;??; <
await@@ 

_dbContext@@ 
.@@ 
SaveChangesAsync@@ -
(@@- .
)@@. /
;@@/ 0
}AA 	
}BB 
}CC ¦2
JC:\Visual\Pruebas\ClinicManager\ClinicManager\Services\PacientesService.cs
	namespace 	
ClinicManager
 
. 
Services  
{ 
public 

class 
PacientesService !
{ 
private		 
readonly		 
AppDBContext		 %

_dbContext		& 0
;		0 1
public 
PacientesService 
(  
AppDBContext  ,
	dbContext- 6
)6 7
{ 	

_dbContext 
= 
	dbContext "
;" #
} 	
public 
async 
Task 
< 
List 
< 
Paciente '
>' (
>( ) 
GetAllPacientesAsync* >
(> ?
)? @
{ 	
return 
await 

_dbContext #
.# $
	Pacientes$ -
.- .
ToListAsync. 9
(9 :
): ;
;; <
} 	
public 
async 
Task 
< 
Paciente "
?" #
># $ 
GetPacienteByIdAsync% 9
(9 :
int: =
id> @
)@ A
{ 	
return 
await 

_dbContext #
.# $
	Pacientes$ -
. 
Include 
( 
p 
=> 
p 
.  
Citas  %
)% &
. 
FirstOrDefaultAsync $
($ %
p% &
=>' )
p* +
.+ ,

IdPaciente, 6
==7 9
id: <
)< =
;= >
} 	
public 
async 
Task 
AddPacienteAsync *
(* +
Paciente+ 3
paciente4 <
)< =
{ 	
if 
( 
! "
EsValidoNombreApellido '
(' (
paciente( 0
.0 1
Nombre1 7
)7 8
||9 ;
!< ="
EsValidoNombreApellido= S
(S T
pacienteT \
.\ ]
Apellido] e
)e f
)f g
throw 
new 
ValidationException -
(- .
$str. ]
)] ^
;^ _
if!! 
(!! 
!!! 
EsTelefonoValido!! !
(!!! "
paciente!!" *
.!!* +
Telefono!!+ 3
)!!3 4
)!!4 5
throw"" 
new"" 
ValidationException"" -
(""- .
$str"". v
)""v w
;""w x

_dbContext$$ 
.$$ 
	Pacientes$$  
.$$  !
Add$$! $
($$$ %
paciente$$% -
)$$- .
;$$. /
await%% 

_dbContext%% 
.%% 
SaveChangesAsync%% -
(%%- .
)%%. /
;%%/ 0
}&& 	
public(( 
async(( 
Task(( 
UpdatePacienteAsync(( -
(((- .
Paciente((. 6
paciente((7 ?
,((? @
Paciente((A I
existingPaciente((J Z
)((Z [
{)) 	
if** 
(** 
paciente** 
.** 
Nombre** 
!=**  "
existingPaciente**# 3
.**3 4
Nombre**4 :
||**; =
paciente**> F
.**F G
Apellido**G O
!=**P R
existingPaciente**S c
.**c d
Apellido**d l
)**l m
throw++ 
new++ !
BusinessRuleException++ /
(++/ 0
$str++0 j
)++j k
;++k l
if-- 
(-- 
!-- 
EsTelefonoValido-- !
(--! "
paciente--" *
.--* +
Telefono--+ 3
)--3 4
)--4 5
throw.. 
new.. 
ValidationException.. -
(..- .
$str... v
)..v w
;..w x
existingPaciente00 
.00 
Telefono00 %
=00& '
paciente00( 0
.000 1
Telefono001 9
;009 :
existingPaciente11 
.11 
Edad11 !
=11" #
paciente11$ ,
.11, -
Edad11- 1
;111 2

_dbContext33 
.33 
	Pacientes33  
.33  !
Update33! '
(33' (
existingPaciente33( 8
)338 9
;339 :
await44 

_dbContext44 
.44 
SaveChangesAsync44 -
(44- .
)44. /
;44/ 0
}55 	
public77 
async77 
Task77 
DeletePacienteAsync77 -
(77- .
Paciente77. 6
paciente777 ?
)77? @
{88 	
if99 
(99 
paciente99 
.99 
Citas99 
!=99 !
null99" &
&&99' )
paciente99* 2
.992 3
Citas993 8
.998 9
Count999 >
>99? @
$num99A B
)99B C
throw:: 
new:: !
BusinessRuleException:: /
(::/ 0
$str::0 p
)::p q
;::q r

_dbContext<< 
.<< 
	Pacientes<<  
.<<  !
Remove<<! '
(<<' (
paciente<<( 0
)<<0 1
;<<1 2
await== 

_dbContext== 
.== 
SaveChangesAsync== -
(==- .
)==. /
;==/ 0
}>> 	
privateAA 
staticAA 
boolAA "
EsValidoNombreApellidoAA 2
(AA2 3
stringAA3 9
inputAA: ?
)AA? @
{BB 	
returnCC 
inputCC 
.CC 
AllCC 
(CC 
charCC !
.CC! "
IsLetterCC" *
)CC* +
;CC+ ,
}DD 	
privateGG 
staticGG 
boolGG 
EsTelefonoValidoGG ,
(GG, -
stringGG- 3
telefonoGG4 <
)GG< =
{HH 	
returnII 
telefonoII 
.II 
AllII 
(II  
charII  $
.II$ %
IsDigitII% ,
)II, -
&&II. 0
telefonoII1 9
.II9 :
LengthII: @
<=IIA C
$numIID F
;IIF G
}JJ 	
}KK 
}LL Ž(
IC:\Visual\Pruebas\ClinicManager\ClinicManager\Services\DoctoresService.cs
	namespace 	
ClinicManager
 
. 
Services  
{ 
public 

class 
DoctoresService  
{ 
private		 
readonly		 
AppDBContext		 %

_dbContext		& 0
;		0 1
public 
DoctoresService 
( 
AppDBContext +
	dbContext, 5
)5 6
{ 	

_dbContext 
= 
	dbContext "
;" #
} 	
public 
async 
Task 
< 
List 
< 
Doctor %
>% &
>& '
GetAllDoctoresAsync( ;
(; <
)< =
{ 	
return 
await 

_dbContext #
.# $
Doctores$ ,
., -
ToListAsync- 8
(8 9
)9 :
;: ;
} 	
public 
async 
Task 
< 
Doctor  
?  !
>! "
GetDoctorByIdAsync# 5
(5 6
int6 9
id: <
)< =
{ 	
return 
await 

_dbContext #
.# $
Doctores$ ,
. 
Include 
( 
d 
=> 
d 
.  
Citas  %
)% &
. 
FirstOrDefaultAsync $
($ %
d% &
=>' )
d* +
.+ ,
IdDoctor, 4
==5 7
id8 :
): ;
;; <
} 	
public 
async 
Task 
AddDoctorAsync (
(( )
Doctor) /
doctor0 6
)6 7
{ 	
if 
( 
! "
EsValidoNombreApellido '
(' (
doctor( .
.. /
Nombre/ 5
)5 6
||7 9
!: ;"
EsValidoNombreApellido; Q
(Q R
doctorR X
.X Y
ApellidoY a
)a b
)b c
throw 
new 
ValidationException -
(- .
$str. `
)` a
;a b

_dbContext!! 
.!! 
Doctores!! 
.!!  
Add!!  #
(!!# $
doctor!!$ *
)!!* +
;!!+ ,
await"" 

_dbContext"" 
."" 
SaveChangesAsync"" -
(""- .
)"". /
;""/ 0
}## 	
public%% 
async%% 
Task%% 
UpdateDoctorAsync%% +
(%%+ ,
Doctor%%, 2
doctor%%3 9
,%%9 :
Doctor%%; A
existingDoctor%%B P
)%%P Q
{&& 	
if'' 
('' 
doctor'' 
.'' 
Nombre'' 
!=''  
existingDoctor''! /
.''/ 0
Nombre''0 6
||''7 9
doctor'': @
.''@ A
Apellido''A I
!=''J L
existingDoctor''M [
.''[ \
Apellido''\ d
)''d e
throw(( 
new(( 
ValidationException(( -
(((- .
$str((. f
)((f g
;((g h
existingDoctor** 
.** 
Especialidad** '
=**( )
doctor*** 0
.**0 1
Especialidad**1 =
;**= >

_dbContext,, 
.,, 
Doctores,, 
.,,  
Update,,  &
(,,& '
existingDoctor,,' 5
),,5 6
;,,6 7
await-- 

_dbContext-- 
.-- 
SaveChangesAsync-- -
(--- .
)--. /
;--/ 0
}.. 	
public00 
async00 
Task00 
DeleteDoctorAsync00 +
(00+ ,
Doctor00, 2
doctor003 9
)009 :
{11 	
if22 
(22 
doctor22 
.22 
Citas22 
!=22 
null22  $
&&22% '
doctor22( .
.22. /
Citas22/ 4
.224 5
Count225 :
>22; <
$num22= >
)22> ?
throw33 
new33 
ValidationException33 -
(33- .
$str33. l
)33l m
;33m n

_dbContext55 
.55 
Doctores55 
.55  
Remove55  &
(55& '
doctor55' -
)55- .
;55. /
await66 

_dbContext66 
.66 
SaveChangesAsync66 -
(66- .
)66. /
;66/ 0
}77 	
private:: 
static:: 
bool:: "
EsValidoNombreApellido:: 2
(::2 3
string::3 9
input::: ?
)::? @
{;; 	
return<< 
input<< 
.<< 
All<< 
(<< 
char<< !
.<<! "
IsLetter<<" *
)<<* +
;<<+ ,
}== 	
}>> 
}?? À7
FC:\Visual\Pruebas\ClinicManager\ClinicManager\Services\CitasService.cs
	namespace 	
ClinicManager
 
. 
Services  
{ 
public 

class 
CitasService 
{ 
private		 
readonly		 
AppDBContext		 %

_dbContext		& 0
;		0 1
public 
CitasService 
( 
AppDBContext (
	dbContext) 2
)2 3
{ 	

_dbContext 
= 
	dbContext "
;" #
} 	
public 
async 
Task 
< 
List 
< 
Cita #
># $
>$ %
GetAllCitasAsync& 6
(6 7
)7 8
{ 	
return 
await 

_dbContext #
.# $
Citas$ )
. 
Include 
( 
c 
=> 
c 
.  
Paciente  (
)( )
. 
Include 
( 
c 
=> 
c 
.  
Doctor  &
)& '
. 
ToListAsync 
( 
) 
; 
} 	
public 
async 
Task 
< 
Cita 
? 
>  
GetCitaByIdAsync! 1
(1 2
int2 5
id6 8
)8 9
{ 	
return 
await 

_dbContext #
.# $
Citas$ )
. 
Include 
( 
c 
=> 
c 
.  
Paciente  (
)( )
. 
Include 
( 
c 
=> 
c 
.  
Doctor  &
)& '
. 
FirstOrDefaultAsync $
($ %
c% &
=>' )
c* +
.+ ,
IdCita, 2
==3 5
id6 8
)8 9
;9 :
} 	
public   
async   
Task   
AddCitaAsync   &
(  & '
Cita  ' +
cita  , 0
)  0 1
{!! 	
if## 
(## 
cita## 
.## 
Fecha## 
<## 
DateTime## %
.##% &
Now##& )
)##) *
throw$$ 
new$$ 
PastDateException$$ +
($$+ ,
$str$$, ^
)$$^ _
;$$_ `
var'' 
pacienteExiste'' 
=''  
await''! &

_dbContext''' 1
.''1 2
	Pacientes''2 ;
.''; <
AnyAsync''< D
(''D E
p''E F
=>''G I
p''J K
.''K L

IdPaciente''L V
==''W Y
cita''Z ^
.''^ _

IdPaciente''_ i
)''i j
;''j k
if(( 
((( 
!(( 
pacienteExiste(( 
)((  
throw)) 
new)) 
NotFoundException)) +
())+ ,
$")), .
$str)). A
{))A B
cita))B F
.))F G

IdPaciente))G Q
}))Q R
$str))R ]
"))] ^
)))^ _
;))_ `
var,, 
doctorExiste,, 
=,, 
await,, $

_dbContext,,% /
.,,/ 0
Doctores,,0 8
.,,8 9
AnyAsync,,9 A
(,,A B
d,,B C
=>,,D F
d,,G H
.,,H I
IdDoctor,,I Q
==,,R T
cita,,U Y
.,,Y Z
IdDoctor,,Z b
),,b c
;,,c d
if-- 
(-- 
!-- 
doctorExiste-- 
)-- 
throw.. 
new.. 
NotFoundException.. +
(..+ ,
$".., .
$str... ?
{..? @
cita..@ D
...D E
IdDoctor..E M
}..M N
$str..N Y
"..Y Z
)..Z [
;..[ \

_dbContext00 
.00 
Citas00 
.00 
Add00  
(00  !
cita00! %
)00% &
;00& '
await11 

_dbContext11 
.11 
SaveChangesAsync11 -
(11- .
)11. /
;11/ 0
}22 	
public44 
async44 
Task44 
UpdateCitaAsync44 )
(44) *
Cita44* .
cita44/ 3
)443 4
{55 	
if77 
(77 
cita77 
.77 
Fecha77 
<77 
DateTime77 %
.77% &
Now77& )
)77) *
throw88 
new88 
PastDateException88 +
(88+ ,
$str88, ^
)88^ _
;88_ `
var;; 
pacienteExiste;; 
=;;  
await;;! &

_dbContext;;' 1
.;;1 2
	Pacientes;;2 ;
.;;; <
AnyAsync;;< D
(;;D E
p;;E F
=>;;G I
p;;J K
.;;K L

IdPaciente;;L V
==;;W Y
cita;;Z ^
.;;^ _

IdPaciente;;_ i
);;i j
;;;j k
if<< 
(<< 
!<< 
pacienteExiste<< 
)<<  
throw== 
new== 
NotFoundException== +
(==+ ,
$"==, .
$str==. A
{==A B
cita==B F
.==F G

IdPaciente==G Q
}==Q R
$str==R ]
"==] ^
)==^ _
;==_ `
var@@ 
doctorExiste@@ 
=@@ 
await@@ $

_dbContext@@% /
.@@/ 0
Doctores@@0 8
.@@8 9
AnyAsync@@9 A
(@@A B
d@@B C
=>@@D F
d@@G H
.@@H I
IdDoctor@@I Q
==@@R T
cita@@U Y
.@@Y Z
IdDoctor@@Z b
)@@b c
;@@c d
ifAA 
(AA 
!AA 
doctorExisteAA 
)AA 
throwBB 
newBB 
NotFoundExceptionBB +
(BB+ ,
$"BB, .
$strBB. ?
{BB? @
citaBB@ D
.BBD E
IdDoctorBBE M
}BBM N
$strBBN Y
"BBY Z
)BBZ [
;BB[ \

_dbContextDD 
.DD 
CitasDD 
.DD 
UpdateDD #
(DD# $
citaDD$ (
)DD( )
;DD) *
awaitEE 

_dbContextEE 
.EE 
SaveChangesAsyncEE -
(EE- .
)EE. /
;EE/ 0
}FF 	
publicHH 
asyncHH 
TaskHH 
DeleteCitaAsyncHH )
(HH) *
CitaHH* .
citaHH/ 3
)HH3 4
{II 	

_dbContextJJ 
.JJ 
CitasJJ 
.JJ 
RemoveJJ #
(JJ# $
citaJJ$ (
)JJ( )
;JJ) *
awaitKK 

_dbContextKK 
.KK 
SaveChangesAsyncKK -
(KK- .
)KK. /
;KK/ 0
}LL 	
}MM 
}NN Å
8C:\Visual\Pruebas\ClinicManager\ClinicManager\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
builder 
. 
Services 
. 
AddControllers 
(  
)  !
. 
AddJsonOptions 
( 
options 
=> 
options 
. !
JsonSerializerOptions %
.% &
ReferenceHandler& 6
=7 8
System9 ?
.? @
Text@ D
.D E
JsonE I
.I J
SerializationJ W
.W X
ReferenceHandlerX h
.h i
Preservei q
)q r
;r s
builder 
. 
Services 
. #
AddEndpointsApiExplorer (
(( )
)) *
;* +
builder 
. 
Services 
. 
AddSwaggerGen 
( 
)  
;  !
builder 
. 
Services 
. 
AddDbContext 
< 
AppDBContext *
>* +
(+ ,
options, 3
=>4 6
options 
. 
UseSqlServer 
( 
builder  
.  !
Configuration! .
.. /
GetConnectionString/ B
(B C
$strC V
)V W
)W X
)X Y
;Y Z
builder 
. 
Services 
. 
	AddScoped 
< 
CitasService '
>' (
(( )
)) *
;* +
builder 
. 
Services 
. 
	AddScoped 
< 
DoctoresService *
>* +
(+ ,
), -
;- .
builder 
. 
Services 
. 
	AddScoped 
< 
PacientesService +
>+ ,
(, -
)- .
;. /
builder 
. 
Services 
. 
	AddScoped 
< !
ProcedimientosService 0
>0 1
(1 2
)2 3
;3 4
var 
app 
= 	
builder
 
. 
Build 
( 
) 
; 
if 
( 
app 
. 
Environment 
. 
IsDevelopment !
(! "
)" #
)# $
{ 
app!! 
.!! 

UseSwagger!! 
(!! 
)!! 
;!! 
app"" 
."" 
UseSwaggerUI"" 
("" 
)"" 
;"" 
}## 
app&& 
.&& 
UseHttpsRedirection&& 
(&& 
)&& 
;&& 
app)) 
.)) 
UseAuthorization)) 
()) 
))) 
;)) 
app,, 
.,, 
MapControllers,, 
(,, 
),, 
;,, 
await// 
app// 	
.//	 

RunAsync//
 
(// 
)// 
;// Ä
EC:\Visual\Pruebas\ClinicManager\ClinicManager\Models\Procedimiento.cs
	namespace 	
ClinicManager
 
. 
Models 
{ 
public 

class 
Procedimiento 
{ 
[		 	
Key			 
]		 
[

 	
Required

	 
]

 
[ 	
DatabaseGenerated	 
( #
DatabaseGeneratedOption 2
.2 3
Identity3 ;
); <
]< =
[ 	
JsonRequired	 
] 
public 
int 
IdProcedimiento "
{# $
get% (
;( )
set* -
;- .
}/ 0
[ 	
Required	 
] 
[ 	
JsonRequired	 
] 
[ 	
StringLength	 
( 
$num 
, 
ErrorMessage '
=( )
$str* _
)_ `
]` a
public 
string 
Descripcion !
{" #
get$ '
;' (
set) ,
;, -
}. /
=0 1
string2 8
.8 9
Empty9 >
;> ?
[ 	
Required	 
] 
[ 	
JsonRequired	 
] 
[ 	
Range	 
( 
$num 
, 
double 
. 
MaxValue #
,# $
ErrorMessage% 1
=2 3
$str4 Z
)Z [
][ \
public 
decimal 
? 
Costo 
{ 
get  #
;# $
set% (
;( )
}* +
[ 	
Required	 
] 
[ 	
JsonRequired	 
] 
public 
int 
? 
IdCita 
{ 
get  
;  !
set" %
;% &
}' (
public 
Cita 
? 
Cita 
{ 
get 
;  
set! $
;$ %
}& '
} 
} Õ
@C:\Visual\Pruebas\ClinicManager\ClinicManager\Models\Paciente.cs
	namespace 	
ClinicManager
 
. 
Models 
{ 
public 

class 
Paciente 
{ 
[		 	
Key			 
]		 
[

 	
Required

	 
]

 
[ 	
JsonRequired	 
] 
[ 	
DatabaseGenerated	 
( #
DatabaseGeneratedOption 2
.2 3
Identity3 ;
); <
]< =
public 
int 

IdPaciente 
{ 
get  #
;# $
set% (
;( )
}* +
[ 	
Required	 
] 
[ 	
JsonRequired	 
] 
[ 	
RegularExpression	 
( 
$str )
,) *
ErrorMessage+ 7
=8 9
$str: `
)` a
]a b
public 
string 
Nombre 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
string- 3
.3 4
Empty4 9
;9 :
[ 	
Required	 
] 
[ 	
JsonRequired	 
] 
[ 	
RegularExpression	 
( 
$str )
,) *
ErrorMessage+ 7
=8 9
$str: b
)b c
]c d
public 
string 
Apellido 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
string/ 5
.5 6
Empty6 ;
;; <
[ 	
Required	 
] 
[ 	
JsonRequired	 
] 
[ 	
RegularExpression	 
( 
$str &
,& '
ErrorMessage( 4
=5 6
$str7 j
)j k
]k l
public 
string 
Telefono 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
string/ 5
.5 6
Empty6 ;
;; <
[ 	
Required	 
] 
[   	
JsonRequired  	 
]   
[!! 	
Range!!	 
(!! 
$num!! 
,!! 
$num!! 
,!! 
ErrorMessage!! #
=!!$ %
$str!!& I
)!!I J
]!!J K
public"" 
int"" 
?"" 
Edad"" 
{"" 
get"" 
;"" 
set""  #
;""# $
}""% &
public$$ 
ICollection$$ 
<$$ 
Cita$$ 
>$$  
Citas$$! &
{$$' (
get$$) ,
;$$, -
set$$. 1
;$$1 2
}$$3 4
=$$5 6
new$$7 :
List$$; ?
<$$? @
Cita$$@ D
>$$D E
($$E F
)$$F G
;$$G H
}%% 
}&& À
>C:\Visual\Pruebas\ClinicManager\ClinicManager\Models\Doctor.cs
	namespace 	
ClinicManager
 
. 
Models 
{ 
public 

class 
Doctor 
{ 
[		 	
Key			 
]		 
[

 	
Required

	 
]

 
[ 	
DatabaseGenerated	 
( #
DatabaseGeneratedOption 2
.2 3
Identity3 ;
); <
]< =
[ 	
JsonRequired	 
] 
public 
int 
IdDoctor 
{ 
get !
;! "
set# &
;& '
}( )
[ 	
Required	 
] 
[ 	
JsonRequired	 
] 
[ 	
RegularExpression	 
( 
$str )
,) *
ErrorMessage+ 7
=8 9
$str: `
)` a
]a b
public 
string 
Nombre 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
string- 3
.3 4
Empty4 9
;9 :
[ 	
Required	 
] 
[ 	
JsonRequired	 
] 
[ 	
RegularExpression	 
( 
$str )
,) *
ErrorMessage+ 7
=8 9
$str: b
)b c
]c d
public 
string 
Apellido 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
string/ 5
.5 6
Empty6 ;
;; <
[ 	
Required	 
] 
[ 	
JsonRequired	 
] 
public 
string 
Especialidad "
{# $
get% (
;( )
set* -
;- .
}/ 0
=1 2
string3 9
.9 :
Empty: ?
;? @
public 
ICollection 
< 
Cita 
>  
Citas! &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
=5 6
new7 :
List; ?
<? @
Cita@ D
>D E
(E F
)F G
;G H
} 
} ˆ
<C:\Visual\Pruebas\ClinicManager\ClinicManager\Models\Cita.cs
	namespace 	
ClinicManager
 
. 
Models 
{ 
public 

class 
Cita 
{ 
[		 	
Key			 
]		 
[

 	
Required

	 
]

 
[ 	
DatabaseGenerated	 
( #
DatabaseGeneratedOption 2
.2 3
Identity3 ;
); <
]< =
[ 	
JsonRequired	 
] 
public 
int 
IdCita 
{ 
get 
;  
set! $
;$ %
}& '
[ 	
Required	 
] 
[ 	
JsonRequired	 
] 
public 
DateTime 
? 
Fecha 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	
Required	 
] 
[ 	
JsonRequired	 
] 
public 
int 
? 

IdPaciente 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
Paciente 
? 
Paciente !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 	
Required	 
] 
[ 	
JsonRequired	 
] 
public 
int 
? 
IdDoctor 
{ 
get "
;" #
set$ '
;' (
}) *
public 
Doctor 
? 
Doctor 
{ 
get  #
;# $
set% (
;( )
}* +
[ 	
Required	 
] 
public   
string   
Lugar   
{   
get   !
;  ! "
set  # &
;  & '
}  ( )
=  * +
string  , 2
.  2 3
Empty  3 8
;  8 9
public"" 
ICollection"" 
<"" 
Procedimiento"" (
>""( )
Procedimientos""* 8
{""9 :
get""; >
;""> ?
set""@ C
;""C D
}""E F
=""G H
new""I L
List""M Q
<""Q R
Procedimiento""R _
>""_ `
(""` a
)""a b
;""b c
}## 
}$$ Õ
ZC:\Visual\Pruebas\ClinicManager\ClinicManager\Migrations\20250121044029_UpdateMigration.cs
	namespace 	
ClinicManager
 
. 

Migrations "
{ 
public 

partial 
class 
UpdateMigration (
:) *
	Migration+ 4
{		 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder 
. 
AlterColumn (
<( )
string) /
>/ 0
(0 1
name 
: 
$str #
,# $
table 
: 
$str '
,' (
type 
: 
$str %
,% &
	maxLength 
: 
$num 
, 
nullable 
: 
false 
,  

oldClrType 
: 
typeof "
(" #
string# )
)) *
,* +
oldType 
: 
$str (
)( )
;) *
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
migrationBuilder 
. 
AlterColumn (
<( )
string) /
>/ 0
(0 1
name 
: 
$str #
,# $
table 
: 
$str '
,' (
type 
: 
$str %
,% &
nullable 
: 
false 
,  

oldClrType 
: 
typeof "
(" #
string# )
)) *
,* +
oldType   
:   
$str   (
,  ( )
oldMaxLength!! 
:!! 
$num!! !
)!!! "
;!!" #
}"" 	
}## 
}$$ ‹g
[C:\Visual\Pruebas\ClinicManager\ClinicManager\Migrations\20250120223624_InitialMigration.cs
	namespace 	
ClinicManager
 
. 

Migrations "
{ 
public		 

partial		 
class		 
InitialMigration		 )
:		* +
	Migration		, 5
{

 
private 
const 
string 
SqlServerIdentity .
=/ 0
$str1 E
;E F
private 
const 
string 
NVarCharMax (
=) *
$str+ :
;: ;
private 
const 
string 

CitasTable '
=( )
$str* 1
;1 2
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str  
,  !
columns 
: 
table 
=> !
new" %
{ 
IdDoctor 
= 
table $
.$ %
Column% +
<+ ,
int, /
>/ 0
(0 1
type1 5
:5 6
$str7 <
,< =
nullable> F
:F G
falseH M
)M N
. 

Annotation #
(# $
SqlServerIdentity$ 5
,5 6
$str7 =
)= >
,> ?
Nombre 
= 
table "
." #
Column# )
<) *
string* 0
>0 1
(1 2
type2 6
:6 7
NVarCharMax8 C
,C D
nullableE M
:M N
falseO T
)T U
,U V
Apellido 
= 
table $
.$ %
Column% +
<+ ,
string, 2
>2 3
(3 4
type4 8
:8 9
NVarCharMax: E
,E F
nullableG O
:O P
falseQ V
)V W
,W X
Especialidad  
=! "
table# (
.( )
Column) /
</ 0
string0 6
>6 7
(7 8
type8 <
:< =
NVarCharMax> I
,I J
nullableK S
:S T
falseU Z
)Z [
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% 2
,2 3
x4 5
=>6 8
x9 :
.: ;
IdDoctor; C
)C D
;D E
}   
)   
;   
migrationBuilder"" 
."" 
CreateTable"" (
(""( )
name## 
:## 
$str## !
,##! "
columns$$ 
:$$ 
table$$ 
=>$$ !
new$$" %
{%% 

IdPaciente&& 
=&&  
table&&! &
.&&& '
Column&&' -
<&&- .
int&&. 1
>&&1 2
(&&2 3
type&&3 7
:&&7 8
$str&&9 >
,&&> ?
nullable&&@ H
:&&H I
false&&J O
)&&O P
.'' 

Annotation'' #
(''# $
SqlServerIdentity''$ 5
,''5 6
$str''7 =
)''= >
,''> ?
Nombre(( 
=(( 
table(( "
.((" #
Column((# )
<(() *
string((* 0
>((0 1
(((1 2
type((2 6
:((6 7
NVarCharMax((8 C
,((C D
nullable((E M
:((M N
false((O T
)((T U
,((U V
Apellido)) 
=)) 
table)) $
.))$ %
Column))% +
<))+ ,
string)), 2
>))2 3
())3 4
type))4 8
:))8 9
NVarCharMax)): E
,))E F
nullable))G O
:))O P
false))Q V
)))V W
,))W X
Telefono** 
=** 
table** $
.**$ %
Column**% +
<**+ ,
string**, 2
>**2 3
(**3 4
type**4 8
:**8 9
NVarCharMax**: E
,**E F
nullable**G O
:**O P
false**Q V
)**V W
,**W X
Edad++ 
=++ 
table++  
.++  !
Column++! '
<++' (
int++( +
>+++ ,
(++, -
type++- 1
:++1 2
$str++3 8
,++8 9
nullable++: B
:++B C
false++D I
)++I J
},, 
,,, 
constraints-- 
:-- 
table-- "
=>--# %
{.. 
table// 
.// 

PrimaryKey// $
(//$ %
$str//% 3
,//3 4
x//5 6
=>//7 9
x//: ;
.//; <

IdPaciente//< F
)//F G
;//G H
}00 
)00 
;00 
migrationBuilder22 
.22 
CreateTable22 (
(22( )
name33 
:33 

CitasTable33  
,33  !
columns44 
:44 
table44 
=>44 !
new44" %
{55 
IdCita66 
=66 
table66 "
.66" #
Column66# )
<66) *
int66* -
>66- .
(66. /
type66/ 3
:663 4
$str665 :
,66: ;
nullable66< D
:66D E
false66F K
)66K L
.77 

Annotation77 #
(77# $
SqlServerIdentity77$ 5
,775 6
$str777 =
)77= >
,77> ?
Fecha88 
=88 
table88 !
.88! "
Column88" (
<88( )
DateTime88) 1
>881 2
(882 3
type883 7
:887 8
$str889 D
,88D E
nullable88F N
:88N O
false88P U
)88U V
,88V W

IdPaciente99 
=99  
table99! &
.99& '
Column99' -
<99- .
int99. 1
>991 2
(992 3
type993 7
:997 8
$str999 >
,99> ?
nullable99@ H
:99H I
false99J O
)99O P
,99P Q
IdDoctor:: 
=:: 
table:: $
.::$ %
Column::% +
<::+ ,
int::, /
>::/ 0
(::0 1
type::1 5
:::5 6
$str::7 <
,::< =
nullable::> F
:::F G
false::H M
)::M N
,::N O
Lugar;; 
=;; 
table;; !
.;;! "
Column;;" (
<;;( )
string;;) /
>;;/ 0
(;;0 1
type;;1 5
:;;5 6
NVarCharMax;;7 B
,;;B C
nullable;;D L
:;;L M
false;;N S
);;S T
}<< 
,<< 
constraints== 
:== 
table== "
=>==# %
{>> 
table?? 
.?? 

PrimaryKey?? $
(??$ %
$str??% /
,??/ 0
x??1 2
=>??3 5
x??6 7
.??7 8
IdCita??8 >
)??> ?
;??? @
table@@ 
.@@ 

ForeignKey@@ $
(@@$ %
nameAA 
:AA 
$strAA :
,AA: ;
columnBB 
:BB 
xBB  !
=>BB" $
xBB% &
.BB& '
IdDoctorBB' /
,BB/ 0
principalTableCC &
:CC& '
$strCC( 2
,CC2 3
principalColumnDD '
:DD' (
$strDD) 3
,DD3 4
onDeleteEE  
:EE  !
ReferentialActionEE" 3
.EE3 4
CascadeEE4 ;
)EE; <
;EE< =
tableFF 
.FF 

ForeignKeyFF $
(FF$ %
nameGG 
:GG 
$strGG =
,GG= >
columnHH 
:HH 
xHH  !
=>HH" $
xHH% &
.HH& '

IdPacienteHH' 1
,HH1 2
principalTableII &
:II& '
$strII( 3
,II3 4
principalColumnJJ '
:JJ' (
$strJJ) 5
,JJ5 6
onDeleteKK  
:KK  !
ReferentialActionKK" 3
.KK3 4
CascadeKK4 ;
)KK; <
;KK< =
}LL 
)LL 
;LL 
migrationBuilderNN 
.NN 
CreateTableNN (
(NN( )
nameOO 
:OO 
$strOO &
,OO& '
columnsPP 
:PP 
tablePP 
=>PP !
newPP" %
{QQ 
IdProcedimientoRR #
=RR$ %
tableRR& +
.RR+ ,
ColumnRR, 2
<RR2 3
intRR3 6
>RR6 7
(RR7 8
typeRR8 <
:RR< =
$strRR> C
,RRC D
nullableRRE M
:RRM N
falseRRO T
)RRT U
.SS 

AnnotationSS #
(SS# $
SqlServerIdentitySS$ 5
,SS5 6
$strSS7 =
)SS= >
,SS> ?
DescripcionTT 
=TT  !
tableTT" '
.TT' (
ColumnTT( .
<TT. /
stringTT/ 5
>TT5 6
(TT6 7
typeTT7 ;
:TT; <
NVarCharMaxTT= H
,TTH I
nullableTTJ R
:TTR S
falseTTT Y
)TTY Z
,TTZ [
CostoUU 
=UU 
tableUU !
.UU! "
ColumnUU" (
<UU( )
decimalUU) 0
>UU0 1
(UU1 2
typeUU2 6
:UU6 7
$strUU8 G
,UUG H
	precisionUUI R
:UUR S
$numUUT V
,UUV W
scaleUUX ]
:UU] ^
$numUU_ `
,UU` a
nullableUUb j
:UUj k
falseUUl q
)UUq r
,UUr s
IdCitaVV 
=VV 
tableVV "
.VV" #
ColumnVV# )
<VV) *
intVV* -
>VV- .
(VV. /
typeVV/ 3
:VV3 4
$strVV5 :
,VV: ;
nullableVV< D
:VVD E
falseVVF K
)VVK L
}WW 
,WW 
constraintsXX 
:XX 
tableXX "
=>XX# %
{YY 
tableZZ 
.ZZ 

PrimaryKeyZZ $
(ZZ$ %
$strZZ% 8
,ZZ8 9
xZZ: ;
=>ZZ< >
xZZ? @
.ZZ@ A
IdProcedimientoZZA P
)ZZP Q
;ZZQ R
table[[ 
.[[ 

ForeignKey[[ $
([[$ %
name\\ 
:\\ 
$str\\ >
,\\> ?
column]] 
:]] 
x]]  !
=>]]" $
x]]% &
.]]& '
IdCita]]' -
,]]- .
principalTable^^ &
:^^& '

CitasTable^^( 2
,^^2 3
principalColumn__ '
:__' (
$str__) 1
,__1 2
onDelete``  
:``  !
ReferentialAction``" 3
.``3 4
Cascade``4 ;
)``; <
;``< =
}aa 
)aa 
;aa 
migrationBuildercc 
.cc 
CreateIndexcc (
(cc( )
namedd 
:dd 
$strdd )
,dd) *
tableee 
:ee 

CitasTableee !
,ee! "
columnff 
:ff 
$strff "
)ff" #
;ff# $
migrationBuilderhh 
.hh 
CreateIndexhh (
(hh( )
nameii 
:ii 
$strii +
,ii+ ,
tablejj 
:jj 

CitasTablejj !
,jj! "
columnkk 
:kk 
$strkk $
)kk$ %
;kk% &
migrationBuildermm 
.mm 
CreateIndexmm (
(mm( )
namenn 
:nn 
$strnn 0
,nn0 1
tableoo 
:oo 
$stroo '
,oo' (
columnpp 
:pp 
$strpp  
)pp  !
;pp! "
}qq 	
	protectedtt 
overridett 
voidtt 
Downtt  $
(tt$ %
MigrationBuildertt% 5
migrationBuildertt6 F
)ttF G
{uu 	
migrationBuildervv 
.vv 
	DropTablevv &
(vv& '
nameww 
:ww 
$strww &
)ww& '
;ww' (
migrationBuilderyy 
.yy 
	DropTableyy &
(yy& '
namezz 
:zz 

CitasTablezz  
)zz  !
;zz! "
migrationBuilder|| 
.|| 
	DropTable|| &
(||& '
name}} 
:}} 
$str}}  
)}}  !
;}}! "
migrationBuilder 
. 
	DropTable &
(& '
name
€€ 
:
€€ 
$str
€€ !
)
€€! "
;
€€" #
}
 	
}
‚‚ 
}ƒƒ £
LC:\Visual\Pruebas\ClinicManager\ClinicManager\Exceptions\CustomExceptions.cs
	namespace 	
ClinicManager
 
. 

Exceptions "
{ 
public 

class 
PastDateException "
:# $
	Exception% .
{ 
public 
PastDateException  
(  !
string! '
message( /
)/ 0
:1 2
base3 7
(7 8
message8 ?
)? @
{A B
}C D
} 
public 

class 
NotFoundException "
:# $
	Exception% .
{		 
public

 
NotFoundException

  
(

  !
string

! '
message

( /
)

/ 0
:

1 2
base

3 7
(

7 8
message

8 ?
)

? @
{

A B
}

C D
} 
public 

class 
ValidationException $
:% &
	Exception' 0
{ 
public 
ValidationException "
(" #
string# )
message* 1
)1 2
:3 4
base5 9
(9 :
message: A
)A B
{C D
}E F
} 
public 

class !
BusinessRuleException &
:' (
	Exception) 2
{ 
public !
BusinessRuleException $
($ %
string% +
message, 3
)3 4
:5 6
base7 ;
(; <
message< C
)C D
{E F
}G H
} 
} ÔA
UC:\Visual\Pruebas\ClinicManager\ClinicManager\Controllers\ProcedimientosController.cs
	namespace 	
ClinicManager
 
. 
Controllers #
{ 
[ 
Route 

(
 
$str 
) 
] 
[		 
ApiController		 
]		 
public

 

class

 $
ProcedimientosController

 )
:

* +
ControllerBase

, :
{ 
private 
readonly !
ProcedimientosService ."
_procedimientosService/ E
;E F
private 
const 
string 
InternalServerError 0
=1 2
$str3 O
;O P
public $
ProcedimientosController '
(' (!
ProcedimientosService( =!
procedimientosService> S
)S T
{ 	"
_procedimientosService "
=# $!
procedimientosService% :
;: ;
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetAll) /
(/ 0
)0 1
{ 	
var 
procedimientos 
=  
await! &"
_procedimientosService' =
.= >%
GetAllProcedimientosAsync> W
(W X
)X Y
;Y Z
return 
Ok 
( 
procedimientos $
)$ %
;% &
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetById) 0
(0 1
int1 4
id5 7
)7 8
{ 	
try   
{!! 
var"" 
procedimiento"" !
=""" #
await""$ )"
_procedimientosService""* @
.""@ A%
GetProcedimientoByIdAsync""A Z
(""Z [
id""[ ]
)""] ^
;""^ _
if## 
(## 
procedimiento## !
==##" $
null##% )
)##) *
return$$ 
NotFound$$ #
($$# $
new$$$ '
{$$( )
Message$$* 1
=$$2 3
$str$$4 Q
}$$R S
)$$S T
;$$T U
return&& 
Ok&& 
(&& 
procedimiento&& '
)&&' (
;&&( )
}'' 
catch(( 
((( 
	Exception(( 
ex(( 
)((  
{)) 
return** 

StatusCode** !
(**! "
$num**" %
,**% &
new**' *
{**+ ,
Message**- 4
=**5 6
InternalServerError**7 J
,**J K
Details**L S
=**T U
ex**V X
.**X Y
Message**Y `
}**a b
)**b c
;**c d
}++ 
},, 	
[.. 	
HttpPost..	 
].. 
public// 
async// 
Task// 
<// 
IActionResult// '
>//' (
Create//) /
(/// 0
Procedimiento//0 =
procedimiento//> K
)//K L
{00 	
try11 
{22 
await33 "
_procedimientosService33 ,
.33, -!
AddProcedimientoAsync33- B
(33B C
procedimiento33C P
)33P Q
;33Q R
return44 
CreatedAtAction44 &
(44& '
nameof44' -
(44- .
GetById44. 5
)445 6
,446 7
new448 ;
{44< =
id44> @
=44A B
procedimiento44C P
.44P Q
IdProcedimiento44Q `
}44a b
,44b c
procedimiento44d q
)44q r
;44r s
}55 
catch66 
(66 
ValidationException66 &
ex66' )
)66) *
{77 
return88 

BadRequest88 !
(88! "
new88" %
{88& '
Message88( /
=880 1
ex882 4
.884 5
Message885 <
}88= >
)88> ?
;88? @
}99 
catch:: 
(:: 
	Exception:: 
ex:: 
)::  
{;; 
return<< 

StatusCode<< !
(<<! "
$num<<" %
,<<% &
new<<' *
{<<+ ,
Message<<- 4
=<<5 6
InternalServerError<<7 J
,<<J K
Details<<L S
=<<T U
ex<<V X
.<<X Y
Message<<Y `
}<<a b
)<<b c
;<<c d
}== 
}>> 	
[@@ 	
HttpPut@@	 
(@@ 
$str@@ 
)@@ 
]@@ 
publicAA 
asyncAA 
TaskAA 
<AA 
IActionResultAA '
>AA' (
UpdateAA) /
(AA/ 0
intAA0 3
idAA4 6
,AA6 7
ProcedimientoAA8 E
procedimientoAAF S
)AAS T
{BB 	
ifCC 
(CC 
idCC 
!=CC 
procedimientoCC #
.CC# $
IdProcedimientoCC$ 3
)CC3 4
returnDD 

BadRequestDD !
(DD! "
newDD" %
{DD& '
MessageDD( /
=DD0 1
$strDD2 E
}DDF G
)DDG H
;DDH I
tryFF 
{GG 
awaitHH "
_procedimientosServiceHH ,
.HH, -$
UpdateProcedimientoAsyncHH- E
(HHE F
procedimientoHHF S
)HHS T
;HHT U
returnII 
OkII 
(II 
procedimientoII '
)II' (
;II( )
}JJ 
catchKK 
(KK 
ValidationExceptionKK &
exKK' )
)KK) *
{LL 
returnMM 

BadRequestMM !
(MM! "
newMM" %
{MM& '
MessageMM( /
=MM0 1
exMM2 4
.MM4 5
MessageMM5 <
}MM= >
)MM> ?
;MM? @
}NN 
catchOO 
(OO 
	ExceptionOO 
exOO 
)OO  
{PP 
returnQQ 

StatusCodeQQ !
(QQ! "
$numQQ" %
,QQ% &
newQQ' *
{QQ+ ,
MessageQQ- 4
=QQ5 6
InternalServerErrorQQ7 J
,QQJ K
DetailsQQL S
=QQT U
exQQV X
.QQX Y
MessageQQY `
}QQa b
)QQb c
;QQc d
}RR 
}SS 	
[UU 	

HttpDeleteUU	 
(UU 
$strUU 
)UU 
]UU 
publicVV 
asyncVV 
TaskVV 
<VV 
IActionResultVV '
>VV' (
DeleteVV) /
(VV/ 0
intVV0 3
idVV4 6
)VV6 7
{WW 	
tryXX 
{YY 
varZZ 
procedimientoZZ !
=ZZ" #
awaitZZ$ )"
_procedimientosServiceZZ* @
.ZZ@ A%
GetProcedimientoByIdAsyncZZA Z
(ZZZ [
idZZ[ ]
)ZZ] ^
;ZZ^ _
if[[ 
([[ 
procedimiento[[ !
==[[" $
null[[% )
)[[) *
return\\ 
NotFound\\ #
(\\# $
new\\$ '
{\\( )
Message\\* 1
=\\2 3
$str\\4 Q
}\\R S
)\\S T
;\\T U
await^^ "
_procedimientosService^^ ,
.^^, -$
DeleteProcedimientoAsync^^- E
(^^E F
procedimiento^^F S
)^^S T
;^^T U
return__ 
Ok__ 
(__ 
new__ 
{__ 
Message__  '
=__( )
$str__* P
}__Q R
)__R S
;__S T
}`` 
catchaa 
(aa 
	Exceptionaa 
exaa 
)aa  
{bb 
returncc 

StatusCodecc !
(cc! "
$numcc" %
,cc% &
newcc' *
{cc+ ,
Messagecc- 4
=cc5 6
InternalServerErrorcc7 J
,ccJ K
DetailsccL S
=ccT U
exccV X
.ccX Y
MessageccY `
}cca b
)ccb c
;ccc d
}dd 
}ee 	
}ff 
}gg ¥T
PC:\Visual\Pruebas\ClinicManager\ClinicManager\Controllers\PacientesController.cs
	namespace 	
ClinicManager
 
. 
Controllers #
{ 
[ 
Route 

(
 
$str 
) 
] 
[		 
ApiController		 
]		 
public

 

class

 
PacientesController

 $
:

% &
ControllerBase

' 5
{ 
private 
readonly 
PacientesService )
_pacientesService* ;
;; <
private 
const 
string &
InternalServerErrorMessage 7
=8 9
$str: V
;V W
public 
PacientesController "
(" #
PacientesService# 3
pacientesService4 D
)D E
{ 	
_pacientesService 
= 
pacientesService  0
;0 1
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetAll) /
(/ 0
)0 1
{ 	
try 
{ 
var 
	pacientes 
= 
await  %
_pacientesService& 7
.7 8 
GetAllPacientesAsync8 L
(L M
)M N
;N O
return 
Ok 
( 
	pacientes #
)# $
;$ %
} 
catch 
( 
	Exception 
ex 
)  
{ 
return 

StatusCode !
(! "
$num" %
,% &
new' *
{+ ,
Message- 4
=5 6&
InternalServerErrorMessage7 Q
,Q R
DetailsS Z
=[ \
ex] _
._ `
Message` g
}h i
)i j
;j k
} 
}   	
["" 	
HttpGet""	 
("" 
$str"" 
)"" 
]"" 
public## 
async## 
Task## 
<## 
IActionResult## '
>##' (
GetById##) 0
(##0 1
int##1 4
id##5 7
)##7 8
{$$ 	
try%% 
{&& 
var'' 
paciente'' 
='' 
await'' $
_pacientesService''% 6
.''6 7 
GetPacienteByIdAsync''7 K
(''K L
id''L N
)''N O
;''O P
if(( 
((( 
paciente(( 
==(( 
null((  $
)(($ %
throw)) 
new)) 
NotFoundException)) /
())/ 0
$str))0 H
)))H I
;))I J
return++ 
Ok++ 
(++ 
paciente++ "
)++" #
;++# $
},, 
catch-- 
(-- 
NotFoundException-- $
ex--% '
)--' (
{.. 
return// 
NotFound// 
(//  
new//  #
{//$ %
Message//& -
=//. /
ex//0 2
.//2 3
Message//3 :
}//; <
)//< =
;//= >
}00 
catch11 
(11 
	Exception11 
ex11 
)11  
{22 
return33 

StatusCode33 !
(33! "
$num33" %
,33% &
new33' *
{33+ ,
Message33- 4
=335 6&
InternalServerErrorMessage337 Q
,33Q R
Details33S Z
=33[ \
ex33] _
.33_ `
Message33` g
}33h i
)33i j
;33j k
}44 
}55 	
[77 	
HttpPost77	 
]77 
public88 
async88 
Task88 
<88 
IActionResult88 '
>88' (
Create88) /
(88/ 0
Paciente880 8
paciente889 A
)88A B
{99 	
try:: 
{;; 
await<< 
_pacientesService<< '
.<<' (
AddPacienteAsync<<( 8
(<<8 9
paciente<<9 A
)<<A B
;<<B C
CreatedAtAction== #
(==# $
nameof==$ *
(==* +
GetById==+ 2
)==2 3
,==3 4
new==5 8
{==9 :
id==; =
===> ?
paciente==@ H
.==H I

IdPaciente==I S
}==T U
,==U V
paciente==W _
)==_ `
;==` a
return>> 
Ok>> 
(>> 
paciente>> "
)>>" #
;>># $
}?? 
catch@@ 
(@@ 
ValidationException@@ &
ex@@' )
)@@) *
{AA 
returnBB 

BadRequestBB !
(BB! "
newBB" %
{BB& '
MessageBB( /
=BB0 1
exBB2 4
.BB4 5
MessageBB5 <
}BB= >
)BB> ?
;BB? @
}CC 
catchDD 
(DD 
	ExceptionDD 
exDD 
)DD  
{EE 
returnFF 

StatusCodeFF !
(FF! "
$numFF" %
,FF% &
newFF' *
{GG 
MessageHH 
=HH 
$strHH :
,HH: ;
DetailsII 
=II 
exII  
.II  !
InnerExceptionII! /
?II/ 0
.II0 1
MessageII1 8
??II9 ;
exII< >
.II> ?
MessageII? F
}JJ 
)JJ 
;JJ 
}KK 
}MM 	
[OO 	
HttpPutOO	 
(OO 
$strOO 
)OO 
]OO 
publicPP 
asyncPP 
TaskPP 
<PP 
IActionResultPP '
>PP' (
UpdatePP) /
(PP/ 0
intPP0 3
idPP4 6
,PP6 7
PacientePP8 @
pacientePPA I
)PPI J
{QQ 	
ifRR 
(RR 
idRR 
!=RR 
pacienteRR 
.RR 

IdPacienteRR )
)RR) *
returnSS 

BadRequestSS !
(SS! "
newSS" %
{SS& '
MessageSS( /
=SS0 1
$strSS2 E
}SSF G
)SSG H
;SSH I
tryUU 
{VV 
varWW 
existingPacienteWW $
=WW% &
awaitWW' ,
_pacientesServiceWW- >
.WW> ? 
GetPacienteByIdAsyncWW? S
(WWS T
idWWT V
)WWV W
;WWW X
ifXX 
(XX 
existingPacienteXX $
==XX% '
nullXX( ,
)XX, -
throwYY 
newYY 
NotFoundExceptionYY /
(YY/ 0
$strYY0 H
)YYH I
;YYI J
await[[ 
_pacientesService[[ '
.[[' (
UpdatePacienteAsync[[( ;
([[; <
paciente[[< D
,[[D E
existingPaciente[[F V
)[[V W
;[[W X
return\\ 
Ok\\ 
(\\ 
existingPaciente\\ *
)\\* +
;\\+ ,
}]] 
catch^^ 
(^^ 
NotFoundException^^ $
ex^^% '
)^^' (
{__ 
return`` 
NotFound`` 
(``  
new``  #
{``$ %
Message``& -
=``. /
ex``0 2
.``2 3
Message``3 :
}``; <
)``< =
;``= >
}aa 
catchbb 
(bb 
ValidationExceptionbb &
exbb' )
)bb) *
{cc 
returndd 

BadRequestdd !
(dd! "
newdd" %
{dd& '
Messagedd( /
=dd0 1
exdd2 4
.dd4 5
Messagedd5 <
}dd= >
)dd> ?
;dd? @
}ee 
catchff 
(ff 
	Exceptionff 
exff 
)ff  
{gg 
returnhh 

StatusCodehh !
(hh! "
$numhh" %
,hh% &
newhh' *
{hh+ ,
Messagehh- 4
=hh5 6&
InternalServerErrorMessagehh7 Q
,hhQ R
DetailshhS Z
=hh[ \
exhh] _
.hh_ `
Messagehh` g
}hhh i
)hhi j
;hhj k
}ii 
}jj 	
[ll 	

HttpDeletell	 
(ll 
$strll 
)ll 
]ll 
publicmm 
asyncmm 
Taskmm 
<mm 
IActionResultmm '
>mm' (
Deletemm) /
(mm/ 0
intmm0 3
idmm4 6
)mm6 7
{nn 	
tryoo 
{pp 
varqq 
pacienteqq 
=qq 
awaitqq $
_pacientesServiceqq% 6
.qq6 7 
GetPacienteByIdAsyncqq7 K
(qqK L
idqqL N
)qqN O
;qqO P
ifrr 
(rr 
pacienterr 
==rr 
nullrr  $
)rr$ %
throwss 
newss 
NotFoundExceptionss /
(ss/ 0
$strss0 H
)ssH I
;ssI J
awaituu 
_pacientesServiceuu '
.uu' (
DeletePacienteAsyncuu( ;
(uu; <
pacienteuu< D
)uuD E
;uuE F
returnvv 
Okvv 
(vv 
newvv 
{vv 
Messagevv  '
=vv( )
$strvv* K
}vvL M
)vvM N
;vvN O
}ww 
catchxx 
(xx 
NotFoundExceptionxx $
exxx% '
)xx' (
{yy 
returnzz 
NotFoundzz 
(zz  
newzz  #
{zz$ %
Messagezz& -
=zz. /
exzz0 2
.zz2 3
Messagezz3 :
}zz; <
)zz< =
;zz= >
}{{ 
catch|| 
(|| !
BusinessRuleException|| (
ex||) +
)||+ ,
{}} 
return~~ 

BadRequest~~ !
(~~! "
new~~" %
{~~& '
Message~~( /
=~~0 1
ex~~2 4
.~~4 5
Message~~5 <
}~~= >
)~~> ?
;~~? @
} 
catch
€€ 
(
€€ 
	Exception
€€ 
ex
€€ 
)
€€  
{
 
return
‚‚ 

StatusCode
‚‚ !
(
‚‚! "
$num
‚‚" %
,
‚‚% &
new
‚‚' *
{
‚‚+ ,
Message
‚‚- 4
=
‚‚5 6(
InternalServerErrorMessage
‚‚7 Q
,
‚‚Q R
Details
‚‚S Z
=
‚‚[ \
ex
‚‚] _
.
‚‚_ `
Message
‚‚` g
}
‚‚h i
)
‚‚i j
;
‚‚j k
}
ƒƒ 
}
„„ 	
}
…… 
}†† ÊG
OC:\Visual\Pruebas\ClinicManager\ClinicManager\Controllers\DoctoresController.cs
	namespace 	
ClinicManager
 
. 
Controllers #
{ 
[ 
Route 

(
 
$str 
) 
] 
[		 
ApiController		 
]		 
public

 

class

 
DoctoresController

 #
:

$ %
ControllerBase

& 4
{ 
private 
readonly 
DoctoresService (
_doctoresService) 9
;9 :
private 
const 
string 
InternalServerError 0
=1 2
$str3 O
;O P
public 
DoctoresController !
(! "
DoctoresService" 1
doctoresService2 A
)A B
{ 	
_doctoresService 
= 
doctoresService .
;. /
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetAll) /
(/ 0
)0 1
{ 	
var 
doctores 
= 
await  
_doctoresService! 1
.1 2
GetAllDoctoresAsync2 E
(E F
)F G
;G H
return 
Ok 
( 
doctores 
) 
;  
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetById) 0
(0 1
int1 4
id5 7
)7 8
{ 	
try   
{!! 
var"" 
doctor"" 
="" 
await"" "
_doctoresService""# 3
.""3 4
GetDoctorByIdAsync""4 F
(""F G
id""G I
)""I J
;""J K
if## 
(## 
doctor## 
==## 
null## "
)##" #
return$$ 
NotFound$$ #
($$# $
new$$$ '
{$$( )
Message$$* 1
=$$2 3
$str$$4 J
}$$K L
)$$L M
;$$M N
return&& 
Ok&& 
(&& 
doctor&&  
)&&  !
;&&! "
}'' 
catch(( 
((( 
	Exception(( 
ex(( 
)((  
{)) 
return** 

StatusCode** !
(**! "
$num**" %
,**% &
new**' *
{**+ ,
Message**- 4
=**5 6
InternalServerError**7 J
,**J K
Details**L S
=**T U
ex**V X
.**X Y
Message**Y `
}**a b
)**b c
;**c d
}++ 
},, 	
[.. 	
HttpPost..	 
].. 
public// 
async// 
Task// 
<// 
IActionResult// '
>//' (
Create//) /
(/// 0
Doctor//0 6
doctor//7 =
)//= >
{00 	
try11 
{22 
await33 
_doctoresService33 &
.33& '
AddDoctorAsync33' 5
(335 6
doctor336 <
)33< =
;33= >
return44 
CreatedAtAction44 &
(44& '
nameof44' -
(44- .
GetById44. 5
)445 6
,446 7
new448 ;
{44< =
id44> @
=44A B
doctor44C I
.44I J
IdDoctor44J R
}44S T
,44T U
doctor44V \
)44\ ]
;44] ^
}55 
catch66 
(66 
ValidationException66 &
ex66' )
)66) *
{77 
return88 

BadRequest88 !
(88! "
new88" %
{88& '
Message88( /
=880 1
ex882 4
.884 5
Message885 <
}88= >
)88> ?
;88? @
}99 
catch;; 
(;; 
	Exception;; 
ex;; 
);;  
{<< 
return>> 

StatusCode>> !
(>>! "
$num>>" %
,>>% &
new>>' *
{?? 
Message@@ 
=@@ 
$str@@ :
,@@: ;
DetailsAA 
=AA 
exAA  
.AA  !
InnerExceptionAA! /
?AA/ 0
.AA0 1
MessageAA1 8
??AA9 ;
exAA< >
.AA> ?
MessageAA? F
}BB 
)BB 
;BB 
}CC 
}DD 	
[FF 	
HttpPutFF	 
(FF 
$strFF 
)FF 
]FF 
publicGG 
asyncGG 
TaskGG 
<GG 
IActionResultGG '
>GG' (
UpdateGG) /
(GG/ 0
intGG0 3
idGG4 6
,GG6 7
DoctorGG8 >
doctorGG? E
)GGE F
{HH 	
ifII 
(II 
idII 
!=II 
doctorII 
.II 
IdDoctorII %
)II% &
returnJJ 

BadRequestJJ !
(JJ! "
newJJ" %
{JJ& '
MessageJJ( /
=JJ0 1
$strJJ2 E
}JJF G
)JJG H
;JJH I
tryLL 
{MM 
varNN 
existingDoctorNN "
=NN# $
awaitNN% *
_doctoresServiceNN+ ;
.NN; <
GetDoctorByIdAsyncNN< N
(NNN O
idNNO Q
)NNQ R
;NNR S
ifOO 
(OO 
existingDoctorOO "
==OO# %
nullOO& *
)OO* +
returnPP 
NotFoundPP #
(PP# $
newPP$ '
{PP( )
MessagePP* 1
=PP2 3
$strPP4 J
}PPK L
)PPL M
;PPM N
awaitRR 
_doctoresServiceRR &
.RR& '
UpdateDoctorAsyncRR' 8
(RR8 9
doctorRR9 ?
,RR? @
existingDoctorRRA O
)RRO P
;RRP Q
returnSS 
OkSS 
(SS 
existingDoctorSS (
)SS( )
;SS) *
}TT 
catchUU 
(UU 
ValidationExceptionUU &
exUU' )
)UU) *
{VV 
returnWW 

BadRequestWW !
(WW! "
newWW" %
{WW& '
MessageWW( /
=WW0 1
exWW2 4
.WW4 5
MessageWW5 <
}WW= >
)WW> ?
;WW? @
}XX 
catchYY 
(YY 
	ExceptionYY 
exYY 
)YY  
{ZZ 
return[[ 

StatusCode[[ !
([[! "
$num[[" %
,[[% &
new[[' *
{[[+ ,
Message[[- 4
=[[5 6
InternalServerError[[7 J
,[[J K
Details[[L S
=[[T U
ex[[V X
.[[X Y
Message[[Y `
}[[a b
)[[b c
;[[c d
}\\ 
}]] 	
[__ 	

HttpDelete__	 
(__ 
$str__ 
)__ 
]__ 
public`` 
async`` 
Task`` 
<`` 
IActionResult`` '
>``' (
Delete``) /
(``/ 0
int``0 3
id``4 6
)``6 7
{aa 	
trybb 
{cc 
vardd 
doctordd 
=dd 
awaitdd "
_doctoresServicedd# 3
.dd3 4
GetDoctorByIdAsyncdd4 F
(ddF G
idddG I
)ddI J
;ddJ K
ifee 
(ee 
doctoree 
==ee 
nullee "
)ee" #
returnff 
NotFoundff #
(ff# $
newff$ '
{ff( )
Messageff* 1
=ff2 3
$strff4 J
}ffK L
)ffL M
;ffM N
awaithh 
_doctoresServicehh &
.hh& '
DeleteDoctorAsynchh' 8
(hh8 9
doctorhh9 ?
)hh? @
;hh@ A
returnii 
Okii 
(ii 
newii 
{ii 
Messageii  '
=ii( )
$strii* I
}iiJ K
)iiK L
;iiL M
}jj 
catchkk 
(kk 
ValidationExceptionkk &
exkk' )
)kk) *
{ll 
returnmm 

BadRequestmm !
(mm! "
newmm" %
{mm& '
Messagemm( /
=mm0 1
exmm2 4
.mm4 5
Messagemm5 <
}mm= >
)mm> ?
;mm? @
}nn 
catchoo 
(oo 
	Exceptionoo 
exoo 
)oo  
{pp 
returnqq 

StatusCodeqq !
(qq! "
$numqq" %
,qq% &
newqq' *
{qq+ ,
Messageqq- 4
=qq5 6
InternalServerErrorqq7 J
,qqJ K
DetailsqqL S
=qqT U
exqqV X
.qqX Y
MessageqqY `
}qqa b
)qqb c
;qqc d
}rr 
}ss 	
}tt 
}uu Ï<
LC:\Visual\Pruebas\ClinicManager\ClinicManager\Controllers\CitasController.cs
	namespace 	
ClinicManager
 
. 
Controllers #
{ 
[ 
Route 

(
 
$str 
) 
] 
[		 
ApiController		 
]		 
public

 

class

 
CitasController

  
:

! "
ControllerBase

# 1
{ 
private 
readonly 
CitasService %
_citasService& 3
;3 4
public 
CitasController 
( 
CitasService +
citasService, 8
)8 9
{ 	
_citasService 
= 
citasService (
;( )
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetAll) /
(/ 0
)0 1
{ 	
var 
citas 
= 
await 
_citasService +
.+ ,
GetAllCitasAsync, <
(< =
)= >
;> ?
return 
Ok 
( 
citas 
) 
; 
} 	
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetById) 0
(0 1
int1 4
id5 7
)7 8
{ 	
var 
cita 
= 
await 
_citasService *
.* +
GetCitaByIdAsync+ ;
(; <
id< >
)> ?
;? @
if 
( 
cita 
== 
null 
) 
return 
NotFound 
(  
new  #
{$ %
Message& -
=. /
$str0 D
}E F
)F G
;G H
return!! 
Ok!! 
(!! 
cita!! 
)!! 
;!! 
}"" 	
[$$ 	
HttpPost$$	 
]$$ 
public%% 
async%% 
Task%% 
<%% 
IActionResult%% '
>%%' (
Create%%) /
(%%/ 0
Cita%%0 4
cita%%5 9
)%%9 :
{&& 	
try'' 
{(( 
await)) 
_citasService)) #
.))# $
AddCitaAsync))$ 0
())0 1
cita))1 5
)))5 6
;))6 7
return** 
CreatedAtAction** &
(**& '
nameof**' -
(**- .
GetById**. 5
)**5 6
,**6 7
new**8 ;
{**< =
id**> @
=**A B
cita**C G
.**G H
IdCita**H N
}**O P
,**P Q
cita**R V
)**V W
;**W X
}++ 
catch,, 
(,, 
PastDateException,, $
ex,,% '
),,' (
{-- 
return.. 

BadRequest.. !
(..! "
new.." %
{..& '
Message..( /
=..0 1
ex..2 4
...4 5
Message..5 <
}..= >
)..> ?
;..? @
}// 
catch00 
(00 
NotFoundException00 $
ex00% '
)00' (
{11 
return22 
NotFound22 
(22  
new22  #
{22$ %
Message22& -
=22. /
ex220 2
.222 3
Message223 :
}22; <
)22< =
;22= >
}33 
catch44 
(44 
ValidationException44 &
ex44' )
)44) *
{55 
return66 

BadRequest66 !
(66! "
new66" %
{66& '
Message66( /
=660 1
ex662 4
.664 5
Message665 <
}66= >
)66> ?
;66? @
}77 
}88 	
[:: 	
HttpPut::	 
(:: 
$str:: 
):: 
]:: 
public;; 
async;; 
Task;; 
<;; 
IActionResult;; '
>;;' (
Update;;) /
(;;/ 0
int;;0 3
id;;4 6
,;;6 7
Cita;;8 <
cita;;= A
);;A B
{<< 	
if== 
(== 
id== 
!=== 
cita== 
.== 
IdCita== !
)==! "
return>> 

BadRequest>> !
(>>! "
new>>" %
{>>& '
Message>>( /
=>>0 1
$str>>2 E
}>>F G
)>>G H
;>>H I
try@@ 
{AA 
awaitBB 
_citasServiceBB #
.BB# $
UpdateCitaAsyncBB$ 3
(BB3 4
citaBB4 8
)BB8 9
;BB9 :
returnCC 
OkCC 
(CC 
citaCC 
)CC 
;CC  
}DD 
catchEE 
(EE 
PastDateExceptionEE $
exEE% '
)EE' (
{FF 
returnGG 

BadRequestGG !
(GG! "
newGG" %
{GG& '
MessageGG( /
=GG0 1
exGG2 4
.GG4 5
MessageGG5 <
}GG= >
)GG> ?
;GG? @
}HH 
catchII 
(II 
NotFoundExceptionII $
exII% '
)II' (
{JJ 
returnKK 
NotFoundKK 
(KK  
newKK  #
{KK$ %
MessageKK& -
=KK. /
exKK0 2
.KK2 3
MessageKK3 :
}KK; <
)KK< =
;KK= >
}LL 
catchMM 
(MM 
ValidationExceptionMM &
exMM' )
)MM) *
{NN 
returnOO 

BadRequestOO !
(OO! "
newOO" %
{OO& '
MessageOO( /
=OO0 1
exOO2 4
.OO4 5
MessageOO5 <
}OO= >
)OO> ?
;OO? @
}PP 
}QQ 	
[SS 	

HttpDeleteSS	 
(SS 
$strSS 
)SS 
]SS 
publicTT 
asyncTT 
TaskTT 
<TT 
IActionResultTT '
>TT' (
DeleteTT) /
(TT/ 0
intTT0 3
idTT4 6
)TT6 7
{UU 	
varVV 
citaVV 
=VV 
awaitVV 
_citasServiceVV *
.VV* +
GetCitaByIdAsyncVV+ ;
(VV; <
idVV< >
)VV> ?
;VV? @
ifWW 
(WW 
citaWW 
==WW 
nullWW 
)WW 
returnXX 
NotFoundXX 
(XX  
newXX  #
{XX$ %
MessageXX& -
=XX. /
$strXX0 D
}XXE F
)XXF G
;XXG H
tryZZ 
{[[ 
await\\ 
_citasService\\ #
.\\# $
DeleteCitaAsync\\$ 3
(\\3 4
cita\\4 8
)\\8 9
;\\9 :
return]] 
Ok]] 
(]] 
new]] 
{]] 
Message]]  '
=]]( )
$str]]* G
}]]H I
)]]I J
;]]J K
}^^ 
catch__ 
(__ 
ValidationException__ &
ex__' )
)__) *
{`` 
returnaa 

BadRequestaa !
(aa! "
newaa" %
{aa& '
Messageaa( /
=aa0 1
exaa2 4
.aa4 5
Messageaa5 <
}aa= >
)aa> ?
;aa? @
}bb 
}cc 	
}dd 
}ee —
=C:\Visual\Pruebas\ClinicManager\ClinicManager\AppDBContext.cs
	namespace 	
ClinicManager
 
{ 
public 

class 
AppDBContext 
: 
	DbContext  )
{ 
public 
AppDBContext 
( 
DbContextOptions ,
<, -
AppDBContext- 9
>9 :
options; B
)B C
:D E
baseF J
(J K
optionsK R
)R S
{T U
}V W
public

 
DbSet

 
<

 
Paciente

 
>

 
	Pacientes

 (
{

) *
get

+ .
;

. /
set

0 3
;

3 4
}

5 6
public 
DbSet 
< 
Doctor 
> 
Doctores %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
DbSet 
< 
Cita 
> 
Citas  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
DbSet 
< 
Procedimiento "
>" #
Procedimientos$ 2
{3 4
get5 8
;8 9
set: =
;= >
}? @
	protected 
override 
void 
OnModelCreating  /
(/ 0
ModelBuilder0 <
modelBuilder= I
)I J
{ 	
modelBuilder 
. 
Entity 
<  
Procedimiento  -
>- .
(. /
)/ 0
. 
Property 
( 
p 
=> 
p  
.  !
Costo! &
)& '
. 
HasPrecision 
( 
$num  
,  !
$num" #
)# $
;$ %
modelBuilder 
. 
Entity 
<  
Cita  $
>$ %
(% &
)& '
. 
HasOne 
( 
c 
=> 
c 
. 
Paciente '
)' (
. 
WithMany 
( 
p 
=> 
p  
.  !
Citas! &
)& '
. 
HasForeignKey 
( 
c  
=>! #
c$ %
.% &

IdPaciente& 0
)0 1
;1 2
modelBuilder 
. 
Entity 
<  
Cita  $
>$ %
(% &
)& '
. 
HasOne 
( 
c 
=> 
c 
. 
Doctor %
)% &
. 
WithMany 
( 
d 
=> 
d  
.  !
Citas! &
)& '
. 
HasForeignKey 
( 
c  
=>! #
c$ %
.% &
IdDoctor& .
). /
;/ 0
modelBuilder!! 
.!! 
Entity!! 
<!!  
Procedimiento!!  -
>!!- .
(!!. /
)!!/ 0
."" 
HasOne"" 
("" 
p"" 
=>"" 
p"" 
."" 
Cita"" #
)""# $
.## 
WithMany## 
(## 
c## 
=>## 
c##  
.##  !
Procedimientos##! /
)##/ 0
.$$ 
HasForeignKey$$ 
($$ 
p$$  
=>$$! #
p$$$ %
.$$% &
IdCita$$& ,
)$$, -
;$$- .
base&& 
.&& 
OnModelCreating&&  
(&&  !
modelBuilder&&! -
)&&- .
;&&. /
}'' 	
}(( 
})) 